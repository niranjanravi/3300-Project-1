<html>

	<head>
		<title>Rap Visuals</title>

		<script src="https://d3js.org/d3.v4.min.js"></script>
		<script src="http://d3js.org/topojson.v2.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
	</head>

	<body>

		<svg height="600" width="600">

		</svg>

		<script>

		var svg = d3.select("svg");
		var fileData;

		var a = {songs: 9, sales: 0.3};

		var rapperData = 
		[
			{name: "fetty_wap" , songs: 31, sales: 0.3},
			{name: "lil_wayne" , songs: 258, sales: 13.4},
			{name: "2_chainz" , songs: 102, sales: 0.9},
			{name: "50_cent" , songs: 186, sales: 15.7},
			{name: "desiigner" , songs: 12, sales: .02},
			{name: "kanye" , songs: 219, sales: 13.5},
			{name: "future" ,songs: 104, sales: 0.8},
			{name: "chief_keef" ,songs: 50, sales: 0.2},
			{name: "drake" ,songs: 153, sales: 7.4},
			{name: "gucci_mane" ,songs: 120, sales: 1.1}
		];


		d3.json("rappers.json",function(data){
			console.log("JSON data loaded");
			fileData = data;
			rapperData.forEach(function(rapper){
				rapper.count = fileData[rapper.name].count;
				rapper.totalwords = fileData[rapper.name].totalwords;
			});
			console.log("file data completely loaded");

			var songExtent = d3.extent(rapperData, function(d){ return d.songs; });
			var saleExtent = d3.extent(rapperData, function(d){ return d.sales; });
			var countExtent = d3.extent(rapperData, function(d){ return d.count/d.totalwords; });

			var songScale = d3.scaleLinear().domain([0, songExtent[1]]).range([20, svg.attr("width") - 20]);
			var saleScale = d3.scaleSqrt().domain([0, saleExtent[1]]).range([svg.attr("height") - 20, 20]);
			var countScale = d3.scaleLinear().domain(countExtent).range([5,20]);

			var songAxis = d3.axisBottom(songScale);
			var saleAxis = d3.axisLeft(saleScale);

			var plot = svg.append("g");
			plot.append("g").attr("transform","translate(0," + (svg.attr("height") - 20) +")").call(songAxis);
			plot.append("g").attr("transform","translate(20,0)").call(saleAxis);

			rapperData.forEach(function(rapper){
				svg.append("circle")
				.attr("cx", songScale(rapper.songs))
				.attr("cy", saleScale(rapper.sales))
				.attr("r", countScale(rapper.count/rapper.totalwords));
			});
		});


		</script>
	</body>
</html>
